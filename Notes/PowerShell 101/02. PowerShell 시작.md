# PowerShell 101
- https://learn.microsoft.com/ko-kr/powershell/scripting/learn/ps101/01-getting-started?view=powershell-7.5

## ㄱ. 개요
- PowerShell
    - Windows 11은 64비트 운영 체제로만 제공됩니다. Windows 11에는 32비트 버전이 없습니다. 그러나 Windows 11에는 32비트 버전의 Windows PowerShell 및 Windows PowerShell ISE가 포함되어 있습니다.
    - UAC는 악성 코드가 상승된 권한으로 실행되지 않도록 하는 Windows 보안 기능입니다.
    - PowerShell 버전 7은 Windows PowerShell 5.1의 대체 버전이 아닙니다.
    - ⓘ Important
        ```
        2017년에 게시된 이 책의 원래 버전은 PowerShell을 시작할 때마다 자동으로 관리자 권한 인스턴스를 시작하도록 작업 표시줄에 바로 가기를 고정하는 것이 좋습니다. 그러나 잠재적인 보안 문제로 인해 더 이상 권장하지 않습니다. 또한 PowerShell의 관리자 권한 인스턴스에서 시작하는 모든 애플리케이션은 UAC를 우회하고 관리자 권한으로 실행됩니다. 예를 들어 PowerShell의 관리자 권한 인스턴스에서 웹 브라우저를 시작하는 경우 악성 코드가 포함된 웹 사이트도 관리자 권한으로 실행됩니다.
        ```
### 1장 - 02. PowerShell 시작
#### PowerShell의 기본 명령
- PS>
    ```
    - $PSVersionTable
        - 파워셸 버전 출력

    - Stop-Service
        - 서비스 정지

    - Get-ExecutionPolicy
        - 스크립트 실행 정책 확인

    - Set-ExecutionPolicy
        - 스크립트 실행 정책을 변경해 실행 허용 범위를 제어하는 보안 기능이다.

    - Get-Service
        - 서비스 상태 확인

    - Get-TimeZone
        - 현재 시스템 시간대 확인

    - Select-Object
        - 명령의 결과를 파이프라인으로 전달받은 객체에서 원하는 속성을 추출한다.
        - 이를 새로운 객체로 반환한다.

    - echo
        - 문자열 출력
        - 'Write-Output'과 동일

    - \[System.Environment\]\:\:
        - .NET 클래스의 정적 멤버에 접근, 시스템 정보에 접근 가능한 명령

    - \[Environment\]\:\:
        - 위와 동일

    - {}
        - 스크립트 블록

    - \$\$
        - 바로 이전 명령 실행

    - \$?
        - 이전 명령의 실행 성공 여부\[ True \| False \]

    - function
        - 함수 정의
    ```

## ㄴ. 특징
- PowerShell에서 명령은 명령어가 아니다.
- PowerShell은 텍스트 출력이 아닌 객체를 반환한다.

## ㄷ. 본문

### Stop-Service
- 서비스 중지
    - 권한 부족으로 인해 서비스 정지와 같은 명령 실행이 불가능하다.
    ```
    PS> Stop-Service -Name 'VMware NAT Service'

    Stop-Service : 다음 오류로 인해 'VMware NAT Service (VMware NAT Service)' 서비스를 중지할 수 없습니다. '.' 컴퓨터의 VMware NAT Service 서비스를 열 수 없습니다.
    위치 줄:1 문자:1
    + Stop-Service -Name 'VMware NAT Service'
    + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        + CategoryInfo          : CloseError: (System.ServiceProcess.ServiceController:ServiceController) [Stop-Service], ServiceCommandException
        + FullyQualifiedErrorId : CouldNotStopService,Microsoft.PowerShell.Commands.StopServiceCommand
    ```

### \$PSVersionTable
- PowerShell 버전 확인
    ```
    PS> $PSVersionTable

    Name                           Value
    ----                           -----
    PSVersion                      5.1.26100.7705
    PSEdition                      Desktop
    PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
    BuildVersion                   10.0.26100.7705
    CLRVersion                     4.0.30319.42000
    WSManStackVersion              3.0
    PSRemotingProtocolVersion      2.3
    SerializationVersion           1.1.0.1
    ```
    
### Get-ExecutionPolicy
- 실행 정책 확인
    ```
    PS> Get-ExecutionPolicy

    Restricted
    ```

- 실행 정책 목록
    ```
            Scope ExecutionPolicy
            ----- ---------------
    MachinePolicy       Undefined
       UserPolicy       Undefined
          Process       Undefined
      CurrentUser    RemoteSigned
     LocalMachine    RemoteSigned
    ```

- 보안 설정 도움말
    - https://learn.microsoft.com/ko-kr/powershell/scripting/learn/ps101/01-getting-started?view=powershell-7.5

### Get-Service -Name W32Time
- 실행중인 서비스의 상태 확인
    ```
    Status   Name               DisplayName
    ------   ----               -----------
    Running  W32Time            Windows Time
    ```

### 권한 설정
- 관리자 권한의 PowerShell에서 실행하여야 권한이 바뀐다.
    ```
    Set-ExecutionPolicy -ExecutionPolicy RemoteSigned
    ```

- 사용자를 특정해 변경할 수도 있다.
    - 사용자 자신의 권한을 변경하는 경우 관리자 권한이 필요 없다.
    ```
    Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
    ```


* .NET:
  Microsoft에서 만든 '애플리케이션 개발 프레임워크'이다.
  주요 기능은 운영체제의 기능을 안전하고 일관된 방식으로 사용할 수 있도록 API를 제공하는 것이다.
  또한 과거엔 Windows 전용이었으나, 현재는 Windows/Linux/MacOS를 지원한다.

* PowerShell:
  PowerShell은 명령의 실행 결과를 문자열이 아닌 '객체 단위'로 반환한다.
  이는 텍스트 기반의 CLI와 달리 표준 출력이 아니며, PowerShell 만의 구조화된 데이터를 다룰 수 있다.
  그렇기에 객체의 '속성' 단위로 정보를 다룰 수 있다.

## ㄹ. 실행 기록
- History
```
  Id CommandLine
  -- -----------
   1 Stop-Service -Name 'VMware NAT Service'
   2 $PSVersionTable
   3 Get-ExecutionPolicy
   4 Get-ExecutionPolicy -List
   5 Get-Service -Name W32Time
   6 Set-ExecutionPolicy -ExecutionPolicy RemoteSigned
   7 Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```