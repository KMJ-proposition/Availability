# PowerShell 101 - Mike F. Robbins
* [3장 - 개체, 속성 및 메서드 검색](https://learn.microsoft.com/ko-kr/powershell/scripting/learn/ps101/03-discovering-objects?view=powershell-7.5) with Microsoft Copilot

* 활용 도구: Microsoft Copilot
    - 단어 선택
    - 기입 제안
    - 문서 검토

## ㄱ. 개요
* PowerShell은 언어
    > PowerShell은 객체 지향 스크립팅 언어입니다. .NET Framework에 정의된 .NET 클래스에서 파생된 구조적 객체를 사용하여 데이터 및 시스템 상태를 나타냅니다.

    > PowerShell은 .NET Framework를 활용하여 파일 시스템, 레지스트리 및 WMI(Windows Management Instrumentation) 클래스를 비롯한 다양한 시스템 기능에 대한 액세스를 제공합니다.
    
    > 또한 PowerShell은 강력한 PowerShell 스크립트를 개발하는 데 사용할 수 있는 방대한 클래스 컬렉션을 포함하는 .NET Framework 클래스 라이브러리에 액세스할 수 있습니다.

    > PowerShell에서 각 항목 또는 상태는 탐색하고 조작할 수 있는 객체의 인스턴스입니다. 이 Get-Member cmdlet은 객체 검색을 위해 PowerShell에서 제공하는 기본 도구 중 하나로, 객체의 특성을 표시합니다. 이 장에서는 PowerShell이 객체를 활용하는 방법과 이러한 객체를 검색 및 조작하여 스크립트를 간소화하고 시스템을 보다 효율적으로 관리하는 방법을 살펴봅니다.

### 3장 - 객체 검색, 속성 및 메서드
#### 필수 조건
> 이 챕터의 특정 예제를 따르려면 랩 환경 컴퓨터가 랩 환경 Active Directory 도메인의 일부인지 확인합니다.

> 또한 Windows RSAT(원격 서버 관리 도구)와 함께 번들로 제공되는 Active Directory PowerShell 모듈을 설치해야 합니다.

> Windows 11을 포함하여 Windows 10 빌드 1809 이상을 사용하는 경우 RSAT를 Windows 기능으로 설치할 수 있습니다.

> ⓘ 참고 항목
    >> Active Directory는 Windows Home 버전에서 지원되지 않습니다.

* Host OS - AD Remote Server AT
    - ![W11_AD](<03. Install AD.png>)!
* VMware - AD Server
    - ![WS_AD_DS_1](<WS - AD DS_1.png>)!
    - ![WS_AD_DS_2](<WS - AD DS_2.png>)!

#### 특징
* PowerShell의 출력은 객체 기반 출력이다.
* 객체는 객체와 유사한 개념으로 메서드가 존재하며 이를 수행한다.
* 이론적으로는 파이프를 이용해 무한히 객체를 다룰 수 있다.
    ```PowerShell
    PS> Get-Process | Select-Object -Property ProcessName | Get-Member | Select-Object -Property Equals | Get-Member
    ```

#### 관리 모듈
- Windows 기능 및 서비스에 대한 관리 및 지원을 제공

#### 학습 목표
* PowerShell의 객체 지향을 이해하고 설명할 수 있다.
* Directory Service에 대해 이해한다.
* Active Directory에 대해 이해한다.

#### 주요 명령
* Get-Member
    - PowerShell의 모든 출력의 속성을 다룰 수 있다.
* Select-Object
    - 명령의 객체를 지정해 출력한다.
    - 명령 내에 존재하는 객체를 지정해 해당 객체(또는 객체들)가 출력하는 객체의 값(상태 또는 줄 등)을 출력한다.
    - 이 때 출력된 것 역시 단순 문자열이 아닌 객체이다. 즉, 또 다시 객체를 다룰 수 있다.
    - 단, 행렬이 바뀔 수도 있다.
* Get-Process
    - 현재 사용자가 실행중인 프로세스의 목록을 출력한다.
* Get-ADUser
    - Active Directory 사용자를 조회한다.
    - PowerShell의 모듈인 ActiveDirectory의 명령 중 하나이다.

***

## ㄴ. 본문
* 서비스의 시작과 멈춤 등을 실행하므로 관리자 권한으로 PowerShell을 시작한다.

### 속성() 전달
#### 1. 소개
* Get-Member
    > 객체 기반 출력을 생성하는 모든 PowerShell 명령을 Get-Member에 파이프할 수 있습니다.
    - 이는 PowerShell의 모든 출력의 속성을 다룰 수 있음을 의미한다.
    - 출력된 객체를 다루기에 독립적으로 사용할 수 없다.
        + 파이프로 전달받은 이전 명령의 속성이 필요하다.
    - 출력 첫 줄의 'TypeName'은 반환되는 객체의 형식을 알려준다.
* Select-Object
    - 반환하는 속성을 테이블 형태로 출력한다.
    - 반환되는 속성의 이름을 지정할 수 있다.
    - 마찬가지로 파이프로 전달받은 이전 명령의 객체 속성이 필요하다.
    
#### 2. 사용과 실행
* Get-ADUser
    - 설치 조회
        ```PowerShell
        PS> Get-Command -Module ActiveDirectory

        CommandType     Name                                               Version    Source
        -----------     ----                                               -------    ------
        Cmdlet          Get-ADUser                                         1.0.1.0    ActiveDirectory
        ...
        ```
    - 기본 사용법
    ```PowerShell
    PS> 
    ```
* Get-Member
    - Get-Service 명령과 조합
    - TypeName 부분이 반환되는 객체의 형식을 알려준다.
        ```PowerShell
        PS> Get-Service -Name W32Time | Get-Member    


        TypeName: System.ServiceProcess.ServiceController

        Name                      MemberType    Definition
        ----                      ----------    ----------
        Name                      AliasProperty Name = ServiceName
        ...
        ```
* Select-Object
    - Get-Service 명령과 조합
        ```PowerShell
        Get-Service -Name W32Time | Select-Object -Property *

        Name                : W32Time
        RequiredServices    : {}
        CanPauseAndContinue : False
        ```
    - 다중 속성 선택
        ```PowerShell
        PS> Get-Service -Name W32Time | Select-Object -Property Status, DisplayName, Can*

        Status              : Stopped
        DisplayName         : Windows Time
        CanPauseAndContinue : False
        CanShutdown         : False
        CanStop             : False
        ```
* Get-Process
```PowerShell
```

---

### 메소드(Method)
#### 1. 소개
* Get-Member
    - 객체에서 수행할 수 있는 작업으로, Get-Member를 이용해 Method를 지정해 사용할 수 있다.
* [SQL Server용 안내](https://learn.microsoft.com/ko-kr/powershell/sql-server/download-sql-server-ps-module?view=sqlserver-ps)

#### 2. 사용과 실행
* Get-Member -MemberType Method
    - Method만 출력
        ```PowerShell
        PS> Get-Service -Name W32Time | Get-Member -MemberType Method

        TypeName: System.ServiceProcess.ServiceController

        Name                      MemberType Definition
        ----                      ---------- ----------
        ...
        Start                     Method     void Start(), void Start(string[] args)
        Stop                      Method     void Stop()
        ...
        ```    
    - 'Stop' Method 사용
        ```PowerShell
        PS> (Get-Service -Name W32Time).Stop  

        OverloadDefinitions
        -------------------
        void Stop()
        ```
    - 서비스 상태 확인
        ```PowerShell
        PS> Get-Service -Name W32Time

        Status   Name               DisplayName
        ------   ----               -----------
        Stopped  W32Time            Windows Time
        ```

***